(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4438],{2027:(C,A,h)=>{var d=h(4494),i=h(7839),r={};function f(t,e,a){for(var l=new d(e,a,f),n=0;n<t.length&&!o(t[n],l);n++);if(o(null,l),l.currentItem instanceof Object)l.addReference(l.currentItem);else{var u=function(t){for(var e=0;e<t.length;e++)if(!(t[e+1]&&t[e+1].value instanceof Object))return t[e].value}(l.currentParents);u&&l.addReference(u)}return{value:l.currentItem,key:l.currentKey,references:l.currentReferences,parents:l.currentParents}}function o(t,e){if(null==t)!e.currentItem&&e.options.force&&e.force(e.options.force);else if(t.values)if(e.currentItem){var a=Object.keys(e.currentItem),l=[];a.forEach(function(p){t.deep&&Array.isArray(e.currentItem[p])?e.currentItem[p].forEach(function(I){l.push(I)}):l.push(e.currentItem[p])}),e.setCurrent(a,l)}else e.setCurrent(a,[]);else if(t.get){var n=e.getValue(t.get);!function(t,e){return t.override&&t.currentItem===t.rootContext&&void 0!==t.override[e]}(e,n)?e.currentItem||e.options.force&&e.force({})?function(t,e){return t instanceof Array&&parseInt(e)!=e}(e.currentItem,n)||t.multiple?(l=e.currentItem.map(function(I){return I[n]}).filter(g),l=Array.prototype.concat.apply([],l),e.setCurrent(n,l)):e.setCurrent(n,e.currentItem[n]):e.setCurrent(n,null):e.setCurrent(n,e.override[n])}else if(t.select)if(Array.isArray(e.currentItem)||e.options.force&&e.force([])){var u=(t.boolean?t.select:[t]).map(function(p){if(":"===p.op){var I=e.getValue(p.select[0]);return{func:function(b){return I&&(b=b[I]),e.getValueFrom(p.select[1],b)},negate:p.negate,booleanOp:p.booleanOp}}var F=e.getValues(p.select);if(!e.options.allowRegexp&&"~"===p.op&&F[1]instanceof RegExp)throw new Error("options.allowRegexp is not enabled.");return{key:F[0],value:F[1],negate:p.negate,booleanOp:p.booleanOp,op:p.op}});if(t.multiple){a=[];var O=[];e.currentItem.forEach(function(I,F){s(I,u)&&(a.push(F),O.push(I))}),e.setCurrent(a,O)}else e.currentItem.some(function(p,I){if(s(p,u))return e.setCurrent(I,p),!0})||e.setCurrent(null,null)}else e.setCurrent(null,null);else if(t.root)e.resetCurrent(),e.setCurrent(null,t.args&&t.args.length?e.getValue(t.args[0]):e.rootContext);else if(t.parent)e.resetCurrent(),e.setCurrent(null,e.options.parent);else if(t.or){if(e.currentItem)return!0;e.resetCurrent(),e.setCurrent(null,e.context)}else if(t.filter){var y=e.getLocal(t.filter)||e.getGlobal(t.filter);if("function"==typeof y){l=e.getValues(t.args||[]);var _=y.apply(e.options,[e.currentItem].concat(l));e.setCurrent(null,_)}else{var x=e.getFilter(t.filter);"function"==typeof x&&(l=e.getValues(t.args||[]),_=x.call(e.options,e.currentItem,{args:l,state:e,data:e.rootContext}),e.setCurrent(null,_))}}else if(t.deep)if(e.currentItem){if(0===t.deep.length)return;if(_=e.deepQuery(e.currentItem,t.deep,e.options)){e.setCurrent(_.key,_.value);for(var T=0;T<_.parents.length;T++)e.currentParents.push(_.parents[T])}else e.setCurrent(null,null)}else e.currentItem=null}function s(t,e){for(var a=!1,l=0;l<e.length;l++){var n=e[l],u=!1;n.func?u=n.func(t):"~"===n.op?u=n.value instanceof RegExp?t[n.key]&&!!t[n.key].match(n.value):t[n.key]&&!!~t[n.key].indexOf(n.value):"="===n.op?u=!0===t[n.key]&&"true"===n.value||!1===t[n.key]&&"false"===n.value||t[n.key]==n.value:">"===n.op?u=t[n.key]>n.value:"<"===n.op?u=t[n.key]<n.value:">="===n.op?u=t[n.key]>=n.value:"<="===n.op&&(u=t[n.key]<=n.value),n.negate&&(u=!u),a="&"===n.booleanOp?a&&u:"|"===n.booleanOp&&a||u}return a}function g(t){return void 0!==t}C.exports=function(e,a){var l=a&&a.params||null;return Array.isArray(e)&&(l=e.slice(1),e=e[0]),r[e]||(r[e]=i(e,!0)),f(r[e],a,l)},C.exports.lastParent=function(t){var e=t.parents[t.parents.length-1];return e?e.value:null}},239:C=>{C.exports=function(h,d,i){var r=i&&i.max||1/0,f=i&&i.includeDelimiters||!1,o=0,s=0,g=[],v=[];h.replace(/([\[\(\{])|([\]\)\}])/g,function(e,a,l,n){a?(0===o&&v.push([s,n]),o+=1):l&&0==(o-=1)&&(s=n+e.length)}),0===o&&s<h.length&&v.push([s,h.length]),s=0;for(var P=0;P<v.length&&r>0;P++)for(var c=v[P][0],t=d.exec(h.slice(c,v[P][1]));t&&r>1;s=c+=t.index+t[0].length,t=d.exec(h.slice(c,v[P][1])))g.push(h.slice(s,t.index+c)),f&&g.push(t[0]),r-=1;return s<h.length&&g.push(h.slice(s)),g}},4494:C=>{function A(i,r,f){i=i||{},this.handleQuery=f,this.options=i,this.locals=this.options.locals||{},this.globals=this.options.globals||{},this.rootContext=h(i.data,i.rootContext,i.context,i.source),this.parent=i.parent,this.override=i.override,this.filters=i.filters||{},this.params=r||i.params||[],this.context=h(i.currentItem,i.context,i.source),this.currentItem=h(this.context,i.rootContext,i.data),this.currentKey=null,this.currentReferences=[],this.currentParents=[]}function h(i){for(var r=0;r<arguments.length;r++)if(null!=arguments[r])return arguments[r]}function d(i){var r={};if(i)for(var f in i)f in i&&(r[f]=i[f]);return r}C.exports=A,A.prototype={setCurrent:function(i,r){(this.currentItem||this.currentKey||this.currentParents.length>0)&&this.currentParents.push({key:this.currentKey,value:this.currentItem}),this.currentItem=r,this.currentKey=i},resetCurrent:function(){this.currentItem=null,this.currentKey=null,this.currentParents=[]},force:function(i){var r=this.currentParents[this.currentParents.length-1];return!this.currentItem&&r&&null!=this.currentKey&&(this.currentItem=i||{},r.value[this.currentKey]=this.currentItem),!!this.currentItem},getLocal:function(i){if(~i.indexOf("/")){for(var r=null,f=i.split("/"),o=0;o<f.length;o++){var s=f[o];0==o?r=this.locals[s]:r&&r[s]&&(r=r[s])}return r}return this.locals[i]},getGlobal:function(i){if(~i.indexOf("/")){for(var r=null,f=i.split("/"),o=0;o<f.length;o++){var s=f[o];0==o?r=this.globals[s]:r&&r[s]&&(r=r[s])}return r}return this.globals[i]},getFilter:function(i){if(~i.indexOf("/")){for(var r=null,f=i.split("/"),o=0;o<f.length;o++){var s=f[o];0==o?r=this.filters[s]:r&&r[s]&&(r=r[s])}return r}return this.filters[i]},addReferences:function(i){i&&i.forEach(this.addReference,this)},addReference:function(i){i instanceof Object&&!~this.currentReferences.indexOf(i)&&this.currentReferences.push(i)},getValues:function(i,r){return i.map(this.getValue,this)},getValue:function(i){return this.getValueFrom(i,null)},getValueFrom:function(i,r){if(null!=i._param)return this.params[i._param];if(i._sub){var f=d(this.options);f.force=null,f.currentItem=r;var o=this.handleQuery(i._sub,f,this.params);return this.addReferences(o.references),o.value}return i},deepQuery:function(i,r,f,o){for(var g in Object.keys(i),i)if(g in i){(f=d(this.options)).currentItem=i[g];var v=this.handleQuery(r,f,this.params);if(v.value)return v}return null}}},7839:(C,A,h)=>{var d=h(239);function f(c){var t=d(c,/(!)?(=|~|\:|<=|>=|<|>)/,{max:2,includeDelimiters:!0});if(3===t.length){var e="!"===t[1].charAt(0),a=s(t[0].trim()),l={negate:e,op:e?t[1].slice(1):t[1]};if(":"===l.op)l.select=[a,{_sub:C.exports(":"+t[2].trim())}];else if("~"===l.op){var n=s(t[2].trim());if("string"==typeof n){var u=t[2].trim().match(/^\/(.*)\/([a-z]?)$/);l.select=u?[a,new RegExp(u[1],u[2])]:[a,n]}else l.select=[a,n]}else l.select=[a,s(t[2].trim())];return l}}function s(c){if(function(c){return"{"===c.charAt(0)&&"}"===c.charAt(c.length-1)}(c)){var t=c.slice(1,-1);return{_sub:C.exports(t)}}return function(c){if("?"===c.charAt(0)){var t=parseInt(c.slice(1));return isNaN(t)?c:{_param:t}}return c}(c)}C.exports=function(c,t){if(!c)return[];var l,e=[],n=c.charAt(0),u=0,O=0,y=0,_=0,x=0,T="get",p=null;t&&(c=function(c){var t=0;return c.replace(/\?/g,function(e){return e+t++})}(c));var I={".":{mode:"get"},":":{mode:"filter"},"|":{handle:"or"},"[":{open:"select"},"]":{close:"select"},"{":{open:"meta"},"}":{close:"meta"},"(":{open:"args"},")":{close:"args"}};function F(m){p?p.push(m):e.push(m)}var b={get:function(m){var M="string"==typeof m?m.trim():null;M&&F({get:M})},select:function(m){if(m)F(function(c){if("*"===c)return{values:!0};if("**"===c)return{values:!0,deep:!0};var t=!1;"*"===c.charAt(0)&&(t=!0,c=c.slice(1));var e=d(c,/&|\|/,{includeDelimiters:!0});if(e.length>1){for(var a=[f(e[0].trim())],l=1;l<e.length;l+=2){var n=f(e[l+1].trim());n&&(n.booleanOp=e[l],a.push(n))}return{multiple:t,boolean:!0,select:a}}return(a=f(c.trim()))?(t&&(a.multiple=!0),a):{get:s(c.trim())}}(m));else{var M={deep:[]};e.push(M),p=M.deep}},filter:function(m){m&&F({filter:m.trim()})},or:function(){p=null,e.push({or:!0}),y=S+1},args:function(m){var M=function(c){return","===c?[","]:d(c,/,/).map(function(t){return s(t.trim())})}(m);e[e.length-1].args=M}};function D(){var m=c.slice(u,O);b[T]&&b[T](m),T="get",u=O+1}for(var S=0;S<c.length;S++){l=n,n=c.charAt(S+1),0==(_=S-y)&&":"!==l&&"."!==l&&e.push({root:!0}),0===_&&"."===l&&"."===n&&e.push({parent:!0});var E=I[l];E&&(0===x&&(E.mode||E.open)&&(D(),T=E.mode||E.open),0===x&&E.handle&&(D(),b[E.handle]()),E.open?x+=1:E.close&&(x-=1),0===x&&E.close&&D()),O=S+1}return D(),e}},4438:(C,A,h)=>{"use strict";h.d(A,{a:()=>t});var d=h(3132),r=h(9619),f=h(5415),o=h(1959),s=h(5793),g=h(6019);const v=function(e){return{chip_selected:e}};function P(e,a){if(1&e){const l=r.EpF();r.TgZ(0,"ion-chip",8),r.NdJ("click",function(){const O=r.CHM(l).$implicit,y=r.oxw().$implicit;return r.oxw().onChipClick(y,O)}),r.TgZ(1,"ion-label"),r._uU(2),r.qZA(),r.qZA()}if(2&e){const l=a.$implicit,n=r.oxw().$implicit,u=r.oxw();r.Q6J("ngClass",r.VKq(3,v,u.isFilterSet(n,l))),r.uIk("data-filterProperty",l.replaceAll(" ","_").replaceAll("'","")),r.xp6(2),r.Oqu(l)}}function c(e,a){if(1&e&&(r.TgZ(0,"ion-accordion"),r.TgZ(1,"ion-item",5),r.TgZ(2,"ion-label"),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",6),r.YNc(5,P,3,5,"ion-chip",7),r.qZA(),r.qZA()),2&e){const l=a.$implicit;r.xp6(3),r.Oqu(l.property),r.xp6(2),r.Q6J("ngForOf",l.value)}}let t=(()=>{class e{constructor(l,n,u){this.filterService=l,this.strutturaService=n,this.modalController=u,this.filters=[],this.filters=this.strutturaService.getFilterValues(),this.selectedFilters=this.filterService.getFilters(),console.log(this.filterService.getFilters())}ngOnInit(){console.dir(this.filterService.getFilters())}onChipClick(l,n){let u=this.getFilterByProperty(l);u?u.value.includes(n)?(0,d.remove)(u.value,O=>O===n):u.value.push(n):(u={property:l.property,operator:l.operator,value:[n]},this.selectedFilters.push(u)),console.log(this.filterService.getFilters())}getFilterByProperty(l){return this.selectedFilters.find(n=>n.property==l.property)}getFilterByValue(l,n){return this.selectedFilters.find(u=>u.property==l.property&&u.value.includes(n))}isFilterSet(l,n){return!(0,d.isNil)(this.getFilterByValue(l,n))}applyFilter(){console.log(this.selectedFilters),this.modalController.dismiss({filters:this.selectedFilters})}closeModal(){this.modalController.dismiss()}}return e.\u0275fac=function(l){return new(l||e)(r.Y36(f.F),r.Y36(o.h),r.Y36(s.IN))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-advanced-search"]],decls:13,vars:3,consts:[["slot","start"],[3,"click"],["slot","end"],[3,"multiple","value"],[4,"ngFor","ngForOf"],["slot","header"],["slot","content",1,""],["mode","md","class","filter_chip",3,"ngClass","click",4,"ngFor","ngForOf"],["mode","md",1,"filter_chip",3,"ngClass","click"]],template:function(l,n){1&l&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r.TgZ(2,"ion-buttons",0),r.TgZ(3,"ion-button",1),r.NdJ("click",function(){return n.closeModal()}),r._uU(4,"cancel"),r.qZA(),r.qZA(),r.TgZ(5,"ion-buttons",2),r.TgZ(6,"ion-button",1),r.NdJ("click",function(){return n.applyFilter()}),r._uU(7,"apply"),r.qZA(),r.qZA(),r.TgZ(8,"ion-title"),r._uU(9,"advanced-search"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(10,"ion-content"),r.TgZ(11,"ion-accordion-group",3),r.YNc(12,c,6,2,"ion-accordion",4),r.qZA(),r.qZA()),2&l&&(r.xp6(11),r.Q6J("multiple",!0)("value",1),r.xp6(1),r.Q6J("ngForOf",n.filters))},directives:[s.Gu,s.sr,s.Sm,s.YG,s.wd,s.W2,s.eh,g.sg,s.We,s.Ie,s.Q$,s.hM,g.mk],styles:[".filter_chip[_ngcontent-%COMP%]{text-align:center;background-color:#a0a0a0}.filter_chip.chip_selected[_ngcontent-%COMP%]{background-color:gray;font-weight:bold}"]}),e})()},5415:(C,A,h)=>{"use strict";h.d(A,{F:()=>g});var d=h(3132),r=h(2027),f=h.n(r),o=h(5306),s=h(9619);let g=(()=>{class v{constructor(){this.filters=[]}setFilters(c){this.filters=c}getFilters(){return this.filters}addFilter(c){let t=this.filters.findIndex(e=>e.property==c.property);t>-1?(0,d.set)(this.filters,`[${t}].value`,c.value):this.filters.push(c)}applyFilters(c,t){let e=[],a=[],l=`${t}[*`;return this.filters.map((n,u)=>{switch(n.operator){case o.p.eq:l+=`${n.property}=${n.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.gte:l+=`${n.property}>${n.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.gteq:l+=`${n.property}>=${n.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.lte:l+=`${n.property}<${n.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.lteq:l+=`${n.property}<=${n.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.like:l+=`${n.property}~/.*${n.value}.*/i`,l+=u<this.filters.length-1?" & ":"";break;case o.p.in:a.push(n)}}),l+="]",e=f()(l,{data:c,allowRegexp:!0}).value,a.map(n=>{(0,d.remove)(e,u=>{let O=!n.value.includes(u[n.property]),y=!(0,d.some)(n.value,_=>u[_]);return O&&y})}),e}}return v.\u0275fac=function(c){return new(c||v)},v.\u0275prov=s.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()}}]);