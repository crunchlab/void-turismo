(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4438],{2027:(I,O,h)=>{var d=h(4494),l=h(7839),r={};function f(n,e,s){for(var i=new d(e,s,f),t=0;t<n.length&&!o(n[t],i);t++);if(o(null,i),i.currentItem instanceof Object)i.addReference(i.currentItem);else{var u=function(n){for(var e=0;e<n.length;e++)if(!(n[e+1]&&n[e+1].value instanceof Object))return n[e].value}(i.currentParents);u&&i.addReference(u)}return{value:i.currentItem,key:i.currentKey,references:i.currentReferences,parents:i.currentParents}}function o(n,e){if(null==n)!e.currentItem&&e.options.force&&e.force(e.options.force);else if(n.values)if(e.currentItem){var s=Object.keys(e.currentItem),i=[];s.forEach(function(p){n.deep&&Array.isArray(e.currentItem[p])?e.currentItem[p].forEach(function(C){i.push(C)}):i.push(e.currentItem[p])}),e.setCurrent(s,i)}else e.setCurrent(s,[]);else if(n.get){var t=e.getValue(n.get);!function(n,e){return n.override&&n.currentItem===n.rootContext&&void 0!==n.override[e]}(e,t)?e.currentItem||e.options.force&&e.force({})?function(n,e){return n instanceof Array&&parseInt(e)!=e}(e.currentItem,t)||n.multiple?(i=e.currentItem.map(function(C){return C[t]}).filter(g),i=Array.prototype.concat.apply([],i),e.setCurrent(t,i)):e.setCurrent(t,e.currentItem[t]):e.setCurrent(t,null):e.setCurrent(t,e.override[t])}else if(n.select)if(Array.isArray(e.currentItem)||e.options.force&&e.force([])){var u=(n.boolean?n.select:[n]).map(function(p){if(":"===p.op){var C=e.getValue(p.select[0]);return{func:function(b){return C&&(b=b[C]),e.getValueFrom(p.select[1],b)},negate:p.negate,booleanOp:p.booleanOp}}var y=e.getValues(p.select);if(!e.options.allowRegexp&&"~"===p.op&&y[1]instanceof RegExp)throw new Error("options.allowRegexp is not enabled.");return{key:y[0],value:y[1],negate:p.negate,booleanOp:p.booleanOp,op:p.op}});if(n.multiple){s=[];var A=[];e.currentItem.forEach(function(C,y){a(C,u)&&(s.push(y),A.push(C))}),e.setCurrent(s,A)}else e.currentItem.some(function(p,C){if(a(p,u))return e.setCurrent(C,p),!0})||e.setCurrent(null,null)}else e.setCurrent(null,null);else if(n.root)e.resetCurrent(),e.setCurrent(null,n.args&&n.args.length?e.getValue(n.args[0]):e.rootContext);else if(n.parent)e.resetCurrent(),e.setCurrent(null,e.options.parent);else if(n.or){if(e.currentItem)return!0;e.resetCurrent(),e.setCurrent(null,e.context)}else if(n.filter){var T=e.getLocal(n.filter)||e.getGlobal(n.filter);if("function"==typeof T){i=e.getValues(n.args||[]);var m=T.apply(e.options,[e.currentItem].concat(i));e.setCurrent(null,m)}else{var F=e.getFilter(n.filter);"function"==typeof F&&(i=e.getValues(n.args||[]),m=F.call(e.options,e.currentItem,{args:i,state:e,data:e.rootContext}),e.setCurrent(null,m))}}else if(n.deep)if(e.currentItem){if(0===n.deep.length)return;if(m=e.deepQuery(e.currentItem,n.deep,e.options)){e.setCurrent(m.key,m.value);for(var x=0;x<m.parents.length;x++)e.currentParents.push(m.parents[x])}else e.setCurrent(null,null)}else e.currentItem=null}function a(n,e){for(var s=!1,i=0;i<e.length;i++){var t=e[i],u=!1;t.func?u=t.func(n):"~"===t.op?u=t.value instanceof RegExp?n[t.key]&&!!n[t.key].match(t.value):n[t.key]&&!!~n[t.key].indexOf(t.value):"="===t.op?u=!0===n[t.key]&&"true"===t.value||!1===n[t.key]&&"false"===t.value||n[t.key]==t.value:">"===t.op?u=n[t.key]>t.value:"<"===t.op?u=n[t.key]<t.value:">="===t.op?u=n[t.key]>=t.value:"<="===t.op&&(u=n[t.key]<=t.value),t.negate&&(u=!u),s="&"===t.booleanOp?s&&u:"|"===t.booleanOp&&s||u}return s}function g(n){return void 0!==n}I.exports=function(e,s){var i=s&&s.params||null;return Array.isArray(e)&&(i=e.slice(1),e=e[0]),r[e]||(r[e]=l(e,!0)),f(r[e],s,i)},I.exports.lastParent=function(n){var e=n.parents[n.parents.length-1];return e?e.value:null}},239:I=>{I.exports=function(h,d,l){var r=l&&l.max||1/0,f=l&&l.includeDelimiters||!1,o=0,a=0,g=[],v=[];h.replace(/([\[\(\{])|([\]\)\}])/g,function(e,s,i,t){s?(0===o&&v.push([a,t]),o+=1):i&&0==(o-=1)&&(a=t+e.length)}),0===o&&a<h.length&&v.push([a,h.length]),a=0;for(var P=0;P<v.length&&r>0;P++)for(var c=v[P][0],n=d.exec(h.slice(c,v[P][1]));n&&r>1;a=c+=n.index+n[0].length,n=d.exec(h.slice(c,v[P][1])))g.push(h.slice(a,n.index+c)),f&&g.push(n[0]),r-=1;return a<h.length&&g.push(h.slice(a)),g}},4494:I=>{function O(l,r,f){l=l||{},this.handleQuery=f,this.options=l,this.locals=this.options.locals||{},this.globals=this.options.globals||{},this.rootContext=h(l.data,l.rootContext,l.context,l.source),this.parent=l.parent,this.override=l.override,this.filters=l.filters||{},this.params=r||l.params||[],this.context=h(l.currentItem,l.context,l.source),this.currentItem=h(this.context,l.rootContext,l.data),this.currentKey=null,this.currentReferences=[],this.currentParents=[]}function h(l){for(var r=0;r<arguments.length;r++)if(null!=arguments[r])return arguments[r]}function d(l){var r={};if(l)for(var f in l)f in l&&(r[f]=l[f]);return r}I.exports=O,O.prototype={setCurrent:function(l,r){(this.currentItem||this.currentKey||this.currentParents.length>0)&&this.currentParents.push({key:this.currentKey,value:this.currentItem}),this.currentItem=r,this.currentKey=l},resetCurrent:function(){this.currentItem=null,this.currentKey=null,this.currentParents=[]},force:function(l){var r=this.currentParents[this.currentParents.length-1];return!this.currentItem&&r&&null!=this.currentKey&&(this.currentItem=l||{},r.value[this.currentKey]=this.currentItem),!!this.currentItem},getLocal:function(l){if(~l.indexOf("/")){for(var r=null,f=l.split("/"),o=0;o<f.length;o++){var a=f[o];0==o?r=this.locals[a]:r&&r[a]&&(r=r[a])}return r}return this.locals[l]},getGlobal:function(l){if(~l.indexOf("/")){for(var r=null,f=l.split("/"),o=0;o<f.length;o++){var a=f[o];0==o?r=this.globals[a]:r&&r[a]&&(r=r[a])}return r}return this.globals[l]},getFilter:function(l){if(~l.indexOf("/")){for(var r=null,f=l.split("/"),o=0;o<f.length;o++){var a=f[o];0==o?r=this.filters[a]:r&&r[a]&&(r=r[a])}return r}return this.filters[l]},addReferences:function(l){l&&l.forEach(this.addReference,this)},addReference:function(l){l instanceof Object&&!~this.currentReferences.indexOf(l)&&this.currentReferences.push(l)},getValues:function(l,r){return l.map(this.getValue,this)},getValue:function(l){return this.getValueFrom(l,null)},getValueFrom:function(l,r){if(null!=l._param)return this.params[l._param];if(l._sub){var f=d(this.options);f.force=null,f.currentItem=r;var o=this.handleQuery(l._sub,f,this.params);return this.addReferences(o.references),o.value}return l},deepQuery:function(l,r,f,o){for(var g in Object.keys(l),l)if(g in l){(f=d(this.options)).currentItem=l[g];var v=this.handleQuery(r,f,this.params);if(v.value)return v}return null}}},7839:(I,O,h)=>{var d=h(239);function f(c){var n=d(c,/(!)?(=|~|\:|<=|>=|<|>)/,{max:2,includeDelimiters:!0});if(3===n.length){var e="!"===n[1].charAt(0),s=a(n[0].trim()),i={negate:e,op:e?n[1].slice(1):n[1]};if(":"===i.op)i.select=[s,{_sub:I.exports(":"+n[2].trim())}];else if("~"===i.op){var t=a(n[2].trim());if("string"==typeof t){var u=n[2].trim().match(/^\/(.*)\/([a-z]?)$/);i.select=u?[s,new RegExp(u[1],u[2])]:[s,t]}else i.select=[s,t]}else i.select=[s,a(n[2].trim())];return i}}function a(c){if(function(c){return"{"===c.charAt(0)&&"}"===c.charAt(c.length-1)}(c)){var n=c.slice(1,-1);return{_sub:I.exports(n)}}return function(c){if("?"===c.charAt(0)){var n=parseInt(c.slice(1));return isNaN(n)?c:{_param:n}}return c}(c)}I.exports=function(c,n){if(!c)return[];var i,e=[],t=c.charAt(0),u=0,A=0,T=0,m=0,F=0,x="get",p=null;n&&(c=function(c){var n=0;return c.replace(/\?/g,function(e){return e+n++})}(c));var C={".":{mode:"get"},":":{mode:"filter"},"|":{handle:"or"},"[":{open:"select"},"]":{close:"select"},"{":{open:"meta"},"}":{close:"meta"},"(":{open:"args"},")":{close:"args"}};function y(_){p?p.push(_):e.push(_)}var b={get:function(_){var M="string"==typeof _?_.trim():null;M&&y({get:M})},select:function(_){if(_)y(function(c){if("*"===c)return{values:!0};if("**"===c)return{values:!0,deep:!0};var n=!1;"*"===c.charAt(0)&&(n=!0,c=c.slice(1));var e=d(c,/&|\|/,{includeDelimiters:!0});if(e.length>1){for(var s=[f(e[0].trim())],i=1;i<e.length;i+=2){var t=f(e[i+1].trim());t&&(t.booleanOp=e[i],s.push(t))}return{multiple:n,boolean:!0,select:s}}return(s=f(c.trim()))?(n&&(s.multiple=!0),s):{get:a(c.trim())}}(_));else{var M={deep:[]};e.push(M),p=M.deep}},filter:function(_){_&&y({filter:_.trim()})},or:function(){p=null,e.push({or:!0}),T=S+1},args:function(_){var M=function(c){return","===c?[","]:d(c,/,/).map(function(n){return a(n.trim())})}(_);e[e.length-1].args=M}};function D(){var _=c.slice(u,A);b[x]&&b[x](_),x="get",u=A+1}for(var S=0;S<c.length;S++){i=t,t=c.charAt(S+1),0==(m=S-T)&&":"!==i&&"."!==i&&e.push({root:!0}),0===m&&"."===i&&"."===t&&e.push({parent:!0});var E=C[i];E&&(0===F&&(E.mode||E.open)&&(D(),x=E.mode||E.open),0===F&&E.handle&&(D(),b[E.handle]()),E.open?F+=1:E.close&&(F-=1),0===F&&E.close&&D()),A=S+1}return D(),e}},4438:(I,O,h)=>{"use strict";h.d(O,{a:()=>n});var d=h(3132),r=h(9619),f=h(5415),o=h(1959),a=h(5793),g=h(6019);const v=function(e){return{chip_selected:e}};function P(e,s){if(1&e){const i=r.EpF();r.TgZ(0,"ion-chip",8),r.NdJ("click",function(){const A=r.CHM(i).$implicit,T=r.oxw().$implicit;return r.oxw().onChipClick(T,A)}),r.TgZ(1,"ion-label"),r._uU(2),r.qZA(),r.qZA()}if(2&e){const i=s.$implicit,t=r.oxw().$implicit,u=r.oxw();r.Q6J("ngClass",r.VKq(3,v,u.isFilterSet(t,i))),r.uIk("data-filterProperty",i.replaceAll(" ","_").replaceAll("'","")),r.xp6(2),r.Oqu(i)}}function c(e,s){if(1&e&&(r.TgZ(0,"ion-accordion"),r.TgZ(1,"ion-item",5),r.TgZ(2,"ion-label"),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",6),r.YNc(5,P,3,5,"ion-chip",7),r.qZA(),r.qZA()),2&e){const i=s.$implicit;r.xp6(3),r.Oqu(i.property),r.xp6(2),r.Q6J("ngForOf",i.value)}}let n=(()=>{class e{constructor(i,t,u){this.filterService=i,this.strutturaService=t,this.modalController=u,this.filters=[],this.filters=this.strutturaService.getFilterValues(),this.selectedFilters=this.filterService.getFilters(),console.log(this.filterService.getFilters())}ngOnInit(){console.dir(this.filterService.getFilters())}onChipClick(i,t){let u=this.getFilterByProperty(i);u?u.value.includes(t)?(0,d.remove)(u.value,A=>A===t):u.value.push(t):(u={property:i.property,operator:i.operator,value:[t]},this.selectedFilters.push(u)),console.log(this.filterService.getFilters())}getFilterByProperty(i){return this.selectedFilters.find(t=>t.property==i.property)}getFilterByValue(i,t){return this.selectedFilters.find(u=>u.property==i.property&&u.value.includes(t))}isFilterSet(i,t){return!(0,d.isNil)(this.getFilterByValue(i,t))}applyFilter(){console.log(this.selectedFilters),this.modalController.dismiss({filters:this.selectedFilters})}closeModal(){this.modalController.dismiss()}}return e.\u0275fac=function(i){return new(i||e)(r.Y36(f.F),r.Y36(o.h),r.Y36(a.IN))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-advanced-search"]],decls:13,vars:3,consts:[["slot","start"],[3,"click"],["slot","end"],[3,"multiple","value"],[4,"ngFor","ngForOf"],["slot","header"],["slot","content",1,""],["mode","md","class","filter_chip",3,"ngClass","click",4,"ngFor","ngForOf"],["mode","md",1,"filter_chip",3,"ngClass","click"]],template:function(i,t){1&i&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r.TgZ(2,"ion-buttons",0),r.TgZ(3,"ion-button",1),r.NdJ("click",function(){return t.closeModal()}),r._uU(4,"cancel"),r.qZA(),r.qZA(),r.TgZ(5,"ion-buttons",2),r.TgZ(6,"ion-button",1),r.NdJ("click",function(){return t.applyFilter()}),r._uU(7,"apply"),r.qZA(),r.qZA(),r.TgZ(8,"ion-title"),r._uU(9,"advanced-search"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(10,"ion-content"),r.TgZ(11,"ion-accordion-group",3),r.YNc(12,c,6,2,"ion-accordion",4),r.qZA(),r.qZA()),2&i&&(r.xp6(11),r.Q6J("multiple",!0)("value",1),r.xp6(1),r.Q6J("ngForOf",t.filters))},directives:[a.Gu,a.sr,a.Sm,a.YG,a.wd,a.W2,a.eh,g.sg,a.We,a.Ie,a.Q$,a.hM,g.mk],styles:[".filter_chip[_ngcontent-%COMP%]{text-align:center;background-color:#a0a0a0}.filter_chip.chip_selected[_ngcontent-%COMP%]{background-color:gray;font-weight:bold}"]}),e})()},5415:(I,O,h)=>{"use strict";h.d(O,{F:()=>g});var d=h(3132),r=h(2027),f=h.n(r),o=h(5306),a=h(9619);let g=(()=>{class v{constructor(){this.filters=[]}setFilters(c){this.filters=c}getFilters(){return this.filters}addFilter(c){let n=this.filters.findIndex(e=>e.property==c.property);n>-1?(0,d.set)(this.filters,`[${n}].value`,c.value):this.filters.push(c)}applyFilters(c,n){let e=[],s=[],i=`${n}[*`;return this.filters.map((t,u)=>{switch(t.operator){case o.p.eq:i+=`${t.property}=${t.value}`;break;case o.p.gte:i+=`${t.property}>${t.value}`;break;case o.p.gteq:i+=`${t.property}>=${t.value}`;break;case o.p.lte:i+=`${t.property}<${t.value}`;break;case o.p.lteq:i+=`${t.property}<=${t.value}`;break;case o.p.like:i+=`${t.property}~/.*${t.value}.*/i`;break;case o.p.in:s.push(t)}u<this.filters.length-1&&(i+=" & ")}),i+="]",e=f()(i,{data:c,allowRegexp:!0}).value,s.map(t=>{(0,d.remove)(e,u=>!t.value.includes(u[t.property]))}),e}}return v.\u0275fac=function(c){return new(c||v)},v.\u0275prov=a.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()}}]);