(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4438],{2027:(I,E,d)=>{var m=d(4494),i=d(7839),e={};function p(n,r,s){for(var l=new m(r,s,p),t=0;t<n.length&&!f(n[t],l);t++);if(f(null,l),l.currentItem instanceof Object)l.addReference(l.currentItem);else{var a=function(n){for(var r=0;r<n.length;r++)if(!(n[r+1]&&n[r+1].value instanceof Object))return n[r].value}(l.currentParents);a&&l.addReference(a)}return{value:l.currentItem,key:l.currentKey,references:l.currentReferences,parents:l.currentParents}}function f(n,r){if(null==n)!r.currentItem&&r.options.force&&r.force(r.options.force);else if(n.values)if(r.currentItem){var s=Object.keys(r.currentItem),l=[];s.forEach(function(v){n.deep&&Array.isArray(r.currentItem[v])?r.currentItem[v].forEach(function(A){l.push(A)}):l.push(r.currentItem[v])}),r.setCurrent(s,l)}else r.setCurrent(s,[]);else if(n.get){var t=r.getValue(n.get);!function(n,r){return n.override&&n.currentItem===n.rootContext&&void 0!==n.override[r]}(r,t)?r.currentItem||r.options.force&&r.force({})?function(n,r){return n instanceof Array&&parseInt(r)!=r}(r.currentItem,t)||n.multiple?(l=r.currentItem.map(function(A){return A[t]}).filter(C),l=Array.prototype.concat.apply([],l),r.setCurrent(t,l)):r.setCurrent(t,r.currentItem[t]):r.setCurrent(t,null):r.setCurrent(t,r.override[t])}else if(n.select)if(Array.isArray(r.currentItem)||r.options.force&&r.force([])){var a=(n.boolean?n.select:[n]).map(function(v){if(":"===v.op){var A=r.getValue(v.select[0]);return{func:function(x){return A&&(x=x[A]),r.getValueFrom(v.select[1],x)},negate:v.negate,booleanOp:v.booleanOp}}var T=r.getValues(v.select);if(!r.options.allowRegexp&&"~"===v.op&&T[1]instanceof RegExp)throw new Error("options.allowRegexp is not enabled.");return{key:T[0],value:T[1],negate:v.negate,booleanOp:v.booleanOp,op:v.op}});if(n.multiple){s=[];var u=[];r.currentItem.forEach(function(A,T){c(A,a)&&(s.push(T),u.push(A))}),r.setCurrent(s,u)}else r.currentItem.some(function(v,A){if(c(v,a))return r.setCurrent(A,v),!0})||r.setCurrent(null,null)}else r.setCurrent(null,null);else if(n.root)r.resetCurrent(),r.setCurrent(null,n.args&&n.args.length?r.getValue(n.args[0]):r.rootContext);else if(n.parent)r.resetCurrent(),r.setCurrent(null,r.options.parent);else if(n.or){if(r.currentItem)return!0;r.resetCurrent(),r.setCurrent(null,r.context)}else if(n.filter){var g=r.getLocal(n.filter)||r.getGlobal(n.filter);if("function"==typeof g){l=r.getValues(n.args||[]);var h=g.apply(r.options,[r.currentItem].concat(l));r.setCurrent(null,h)}else{var P=r.getFilter(n.filter);"function"==typeof P&&(l=r.getValues(n.args||[]),h=P.call(r.options,r.currentItem,{args:l,state:r,data:r.rootContext}),r.setCurrent(null,h))}}else if(n.deep)if(r.currentItem){if(0===n.deep.length)return;if(h=r.deepQuery(r.currentItem,n.deep,r.options)){r.setCurrent(h.key,h.value);for(var y=0;y<h.parents.length;y++)r.currentParents.push(h.parents[y])}else r.setCurrent(null,null)}else r.currentItem=null}function c(n,r){for(var s=!1,l=0;l<r.length;l++){var t=r[l],a=!1;t.func?a=t.func(n):"~"===t.op?a=t.value instanceof RegExp?n[t.key]&&!!n[t.key].match(t.value):n[t.key]&&!!~n[t.key].indexOf(t.value):"="===t.op?a=!0===n[t.key]&&"true"===t.value||!1===n[t.key]&&"false"===t.value||n[t.key]==t.value:">"===t.op?a=n[t.key]>t.value:"<"===t.op?a=n[t.key]<t.value:">="===t.op?a=n[t.key]>=t.value:"<="===t.op&&(a=n[t.key]<=t.value),t.negate&&(a=!a),s="&"===t.booleanOp?s&&a:"|"===t.booleanOp&&s||a}return s}function C(n){return void 0!==n}I.exports=function(r,s){var l=s&&s.params||null;return Array.isArray(r)&&(l=r.slice(1),r=r[0]),e[r]||(e[r]=i(r,!0)),p(e[r],s,l)},I.exports.lastParent=function(n){var r=n.parents[n.parents.length-1];return r?r.value:null}},239:I=>{I.exports=function(d,m,i){var e=i&&i.max||1/0,p=i&&i.includeDelimiters||!1,f=0,c=0,C=[],_=[];d.replace(/([\[\(\{])|([\]\)\}])/g,function(r,s,l,t){s?(0===f&&_.push([c,t]),f+=1):l&&0==(f-=1)&&(c=t+r.length)}),0===f&&c<d.length&&_.push([c,d.length]),c=0;for(var b=0;b<_.length&&e>0;b++)for(var o=_[b][0],n=m.exec(d.slice(o,_[b][1]));n&&e>1;c=o+=n.index+n[0].length,n=m.exec(d.slice(o,_[b][1])))C.push(d.slice(c,n.index+o)),p&&C.push(n[0]),e-=1;return c<d.length&&C.push(d.slice(c)),C}},4494:I=>{function E(i,e,p){i=i||{},this.handleQuery=p,this.options=i,this.locals=this.options.locals||{},this.globals=this.options.globals||{},this.rootContext=d(i.data,i.rootContext,i.context,i.source),this.parent=i.parent,this.override=i.override,this.filters=i.filters||{},this.params=e||i.params||[],this.context=d(i.currentItem,i.context,i.source),this.currentItem=d(this.context,i.rootContext,i.data),this.currentKey=null,this.currentReferences=[],this.currentParents=[]}function d(i){for(var e=0;e<arguments.length;e++)if(null!=arguments[e])return arguments[e]}function m(i){var e={};if(i)for(var p in i)p in i&&(e[p]=i[p]);return e}I.exports=E,E.prototype={setCurrent:function(i,e){(this.currentItem||this.currentKey||this.currentParents.length>0)&&this.currentParents.push({key:this.currentKey,value:this.currentItem}),this.currentItem=e,this.currentKey=i},resetCurrent:function(){this.currentItem=null,this.currentKey=null,this.currentParents=[]},force:function(i){var e=this.currentParents[this.currentParents.length-1];return!this.currentItem&&e&&null!=this.currentKey&&(this.currentItem=i||{},e.value[this.currentKey]=this.currentItem),!!this.currentItem},getLocal:function(i){if(~i.indexOf("/")){for(var e=null,p=i.split("/"),f=0;f<p.length;f++){var c=p[f];0==f?e=this.locals[c]:e&&e[c]&&(e=e[c])}return e}return this.locals[i]},getGlobal:function(i){if(~i.indexOf("/")){for(var e=null,p=i.split("/"),f=0;f<p.length;f++){var c=p[f];0==f?e=this.globals[c]:e&&e[c]&&(e=e[c])}return e}return this.globals[i]},getFilter:function(i){if(~i.indexOf("/")){for(var e=null,p=i.split("/"),f=0;f<p.length;f++){var c=p[f];0==f?e=this.filters[c]:e&&e[c]&&(e=e[c])}return e}return this.filters[i]},addReferences:function(i){i&&i.forEach(this.addReference,this)},addReference:function(i){i instanceof Object&&!~this.currentReferences.indexOf(i)&&this.currentReferences.push(i)},getValues:function(i,e){return i.map(this.getValue,this)},getValue:function(i){return this.getValueFrom(i,null)},getValueFrom:function(i,e){if(null!=i._param)return this.params[i._param];if(i._sub){var p=m(this.options);p.force=null,p.currentItem=e;var f=this.handleQuery(i._sub,p,this.params);return this.addReferences(f.references),f.value}return i},deepQuery:function(i,e,p,f){for(var C in Object.keys(i),i)if(C in i){(p=m(this.options)).currentItem=i[C];var _=this.handleQuery(e,p,this.params);if(_.value)return _}return null}}},7839:(I,E,d)=>{var m=d(239);function p(o){var n=m(o,/(!)?(=|~|\:|<=|>=|<|>)/,{max:2,includeDelimiters:!0});if(3===n.length){var r="!"===n[1].charAt(0),s=c(n[0].trim()),l={negate:r,op:r?n[1].slice(1):n[1]};if(":"===l.op)l.select=[s,{_sub:I.exports(":"+n[2].trim())}];else if("~"===l.op){var t=c(n[2].trim());if("string"==typeof t){var a=n[2].trim().match(/^\/(.*)\/([a-z]?)$/);l.select=a?[s,new RegExp(a[1],a[2])]:[s,t]}else l.select=[s,t]}else l.select=[s,c(n[2].trim())];return l}}function c(o){if(function(o){return"{"===o.charAt(0)&&"}"===o.charAt(o.length-1)}(o)){var n=o.slice(1,-1);return{_sub:I.exports(n)}}return function(o){if("?"===o.charAt(0)){var n=parseInt(o.slice(1));return isNaN(n)?o:{_param:n}}return o}(o)}I.exports=function(o,n){if(!o)return[];var l,r=[],t=o.charAt(0),a=0,u=0,g=0,h=0,P=0,y="get",v=null;n&&(o=function(o){var n=0;return o.replace(/\?/g,function(r){return r+n++})}(o));var A={".":{mode:"get"},":":{mode:"filter"},"|":{handle:"or"},"[":{open:"select"},"]":{close:"select"},"{":{open:"meta"},"}":{close:"meta"},"(":{open:"args"},")":{close:"args"}};function T(O){v?v.push(O):r.push(O)}var x={get:function(O){var F="string"==typeof O?O.trim():null;F&&T({get:F})},select:function(O){if(O)T(function(o){if("*"===o)return{values:!0};if("**"===o)return{values:!0,deep:!0};var n=!1;"*"===o.charAt(0)&&(n=!0,o=o.slice(1));var r=m(o,/&|\|/,{includeDelimiters:!0});if(r.length>1){for(var s=[p(r[0].trim())],l=1;l<r.length;l+=2){var t=p(r[l+1].trim());t&&(t.booleanOp=r[l],s.push(t))}return{multiple:n,boolean:!0,select:s}}return(s=p(o.trim()))?(n&&(s.multiple=!0),s):{get:c(o.trim())}}(O));else{var F={deep:[]};r.push(F),v=F.deep}},filter:function(O){O&&T({filter:O.trim()})},or:function(){v=null,r.push({or:!0}),g=R+1},args:function(O){var F=function(o){return","===o?[","]:m(o,/,/).map(function(n){return c(n.trim())})}(O);r[r.length-1].args=F}};function S(){var O=o.slice(a,u);x[y]&&x[y](O),y="get",a=u+1}for(var R=0;R<o.length;R++){l=t,t=o.charAt(R+1),0==(h=R-g)&&":"!==l&&"."!==l&&r.push({root:!0}),0===h&&"."===l&&"."===t&&r.push({parent:!0});var M=A[l];M&&(0===P&&(M.mode||M.open)&&(S(),y=M.mode||M.open),0===P&&M.handle&&(S(),x[M.handle]()),M.open?P+=1:M.close&&(P-=1),0===P&&M.close&&S()),u=R+1}return S(),r}},4438:(I,E,d)=>{"use strict";d.d(E,{a:()=>l});var m=d(3132),e=d(9619),p=d(5415),f=d(1959),c=d(5793),C=d(5924),_=d(6019);function b(t,a){if(1&t){const u=e.EpF();e.TgZ(0,"ion-header"),e.TgZ(1,"ion-toolbar"),e.TgZ(2,"ion-buttons",1),e.TgZ(3,"ion-button",2),e.NdJ("click",function(){return e.CHM(u),e.oxw().closeModal()}),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"ion-title"),e.TgZ(6,"h3"),e._uU(7),e.qZA(),e.qZA(),e.TgZ(8,"ion-buttons",3),e.TgZ(9,"ion-button",2),e.NdJ("click",function(){return e.CHM(u),e.oxw().applyFilter()}),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const u=a.$implicit;e.xp6(4),e.Oqu(u("cancel")),e.xp6(3),e.Oqu(u("advanced-search")),e.xp6(3),e.Oqu(u("apply"))}}const o=function(t){return{chip_selected:t}};function n(t,a){if(1&t){const u=e.EpF();e.TgZ(0,"ion-chip",11),e.NdJ("click",function(){const P=e.CHM(u).$implicit,y=e.oxw().$implicit;return e.oxw(2).onChipClick(y,P)}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA(),e.qZA()}if(2&t){const u=a.$implicit,g=e.oxw().$implicit,h=e.oxw().$implicit,P=e.oxw();e.Q6J("ngClass",e.VKq(4,o,P.isFilterSet(g,u))),e.uIk("data-filterPropertyValue",u.replaceAll(" ","_").replaceAll("'",""))("data-filterPropertyName",g.property.replaceAll(" ","_").replaceAll("'","")),e.xp6(2),e.Oqu(h(u||"NA"))}}function r(t,a){if(1&t&&(e.TgZ(0,"ion-accordion",6),e.TgZ(1,"ion-item",7),e.TgZ(2,"ion-label",8),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",9),e.YNc(5,n,3,6,"ion-chip",10),e.qZA(),e.qZA()),2&t){const u=a.$implicit,g=e.oxw().$implicit;e.Q6J("value",u),e.xp6(3),e.Oqu(g(u.property)),e.xp6(2),e.Q6J("ngForOf",u.value)}}function s(t,a){if(1&t&&(e.TgZ(0,"ion-content"),e.TgZ(1,"ion-accordion-group",4),e.YNc(2,r,6,3,"ion-accordion",5),e.qZA(),e.qZA()),2&t){const u=e.oxw();e.xp6(1),e.Q6J("multiple",!0)("value",u.filters),e.xp6(1),e.Q6J("ngForOf",u.filters)}}let l=(()=>{class t{constructor(u,g,h){this.filterService=u,this.strutturaService=g,this.modalController=h,this.filters=[],this.selectedFilters=[],this.filters=this.strutturaService.getFilterValues(),this.selectedFilters=this.filterService.getFilters(),console.log("constructor",this.filterService.getFilters())}ngOnInit(){console.dir("ngOnInit",this.filterService.getFilters())}onChipClick(u,g){let h=this.getFilterByProperty(u);h?h.value.includes(g)?((0,m.remove)(h.value,P=>P===g),(0,m.remove)(this.selectedFilters,P=>!P.value.length)):h.value.push(g):(h={property:u.property,operator:u.operator,value:[g]},this.selectedFilters.push(h)),console.log(this.filterService.getFilters())}getFilterByProperty(u){return this.selectedFilters.find(g=>g.property==u.property)}getFilterByValue(u,g){return this.selectedFilters.find(h=>h.property==u.property&&h.value.includes(g))}isFilterSet(u,g){return!(0,m.isNil)(this.getFilterByValue(u,g))}applyFilter(){console.log(this.selectedFilters),this.modalController.dismiss({filters:this.selectedFilters})}closeModal(){this.modalController.dismiss()}}return t.\u0275fac=function(u){return new(u||t)(e.Y36(p.F),e.Y36(f.h),e.Y36(c.IN))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-advanced-search"]],decls:2,vars:0,consts:[[4,"transloco"],["slot","start"],["color","light","fill","solid",3,"click"],["slot","end"],[3,"multiple","value"],["toggleIcon","chevron-down-circle-outline",3,"value",4,"ngFor","ngForOf"],["toggleIcon","chevron-down-circle-outline",3,"value"],["slot","header"],[1,"filter_section_name"],["slot","content",1,"filter_values_container"],["mode","md","class","filter_chip",3,"ngClass","click",4,"ngFor","ngForOf"],["mode","md",1,"filter_chip",3,"ngClass","click"]],template:function(u,g){1&u&&(e.YNc(0,b,11,3,"ion-header",0),e.YNc(1,s,3,3,"ion-content",0))},directives:[C.KI,c.Gu,c.sr,c.Sm,c.YG,c.wd,c.W2,c.eh,_.sg,c.We,c.Ie,c.Q$,c.hM,_.mk],styles:[".filter_chip[_ngcontent-%COMP%]{width:auto;text-align:center;flex-grow:3;display:inline-table;white-space:nowrap;background-color:transparent;border-style:solid;border-width:1px;border-color:var(--ion-color-medium)}.filter_chip.chip_selected[_ngcontent-%COMP%]{background-color:#d0d0d0}.filter_chip[data-filterPropertyValue=AFFITTACAMERE][_ngcontent-%COMP%]{border-color:var(--tipologia-background-affittacamere)}.filter_chip[data-filterPropertyValue=AFFITTACAMERE].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-affittacamere)}.filter_chip[data-filterPropertyValue=AGRITURISMO][_ngcontent-%COMP%]{border-color:var(--tipologia-background-agriturismo)}.filter_chip[data-filterPropertyValue=AGRITURISMO].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-agriturismo);color:var(--ion-color-dark)}.filter_chip[data-filterPropertyValue=ALBERGO][_ngcontent-%COMP%]{border-color:var(--tipologia-background-albergo)}.filter_chip[data-filterPropertyValue=ALBERGO].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-albergo)}.filter_chip[data-filterPropertyValue=ALTRA_RICETTIVITA][_ngcontent-%COMP%]{border-color:var(--tipologia-background-altra_ricettivita)}.filter_chip[data-filterPropertyValue=ALTRA_RICETTIVITA].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-altra_ricettivita)}.filter_chip[data-filterPropertyValue=APPARTAMENTO][_ngcontent-%COMP%]{border-color:var(--tipologia-background-appartamento)}.filter_chip[data-filterPropertyValue=APPARTAMENTO].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-appartamento)}.filter_chip[data-filterPropertyValue=BED_AND_BREAKFAST][_ngcontent-%COMP%]{border-color:var(--tipologia-background-bed_and_breakfast)}.filter_chip[data-filterPropertyValue=BED_AND_BREAKFAST].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-bed_and_breakfast)}.filter_chip[data-filterPropertyValue=CAMPEGGIO][_ngcontent-%COMP%]{border-color:var(--tipologia-background-campeggio)}.filter_chip[data-filterPropertyValue=CAMPEGGIO].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-campeggio)}.filter_chip[data-filterPropertyValue=COUNTRY_HOUSE][_ngcontent-%COMP%]{border-color:var(--tipologia-background-country_house)}.filter_chip[data-filterPropertyValue=COUNTRY_HOUSE].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-country_house)}.filter_chip[data-filterPropertyValue=RESIDENCE][_ngcontent-%COMP%]{border-color:var(--tipologia-background-residence)}.filter_chip[data-filterPropertyValue=RESIDENCE].chip_selected[_ngcontent-%COMP%]{background-color:var(--tipologia-background-residence)}.advanced_search[_ngcontent-%COMP%]{background-color:#fff;opacity:1;border-width:0;display:inline-table}.filter_chip[_ngcontent-%COMP%]{text-transform:lowercase;text-align:center;border-width:1px}.filter_values_container[_ngcontent-%COMP%]{margin-left:13px}.filter_section_name[_ngcontent-%COMP%]{text-transform:capitalize}ion-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:auto}"]}),t})()},5415:(I,E,d)=>{"use strict";d.d(E,{F:()=>C});var m=d(3132),e=d(2027),p=d.n(e),f=d(5306),c=d(9619);let C=(()=>{class _{constructor(){this.filters=[]}setFilters(o){this.filters=o}getFilters(){return this.filters}addFilter(o){let n=this.filters.findIndex(r=>r.property==o.property);n>-1?(0,m.set)(this.filters,`[${n}].value`,o.value):this.filters.push(o)}applyFilters(o,n){let r=[],s=[],l=`${n}[*`;return this.filters.map((t,a)=>{switch(t.operator){case f.p.eq:l+=`${t.property}=${t.value}`,l+=a<this.filters.length-1?" & ":"";break;case f.p.gte:l+=`${t.property}>${t.value}`,l+=a<this.filters.length-1?" & ":"";break;case f.p.gteq:l+=`${t.property}>=${t.value}`,l+=a<this.filters.length-1?" & ":"";break;case f.p.lte:l+=`${t.property}<${t.value}`,l+=a<this.filters.length-1?" & ":"";break;case f.p.lteq:l+=`${t.property}<=${t.value}`,l+=a<this.filters.length-1?" & ":"";break;case f.p.like:l+=`${t.property}~/.*${t.value}.*/i`,l+=a<this.filters.length-1?" & ":"";break;case f.p.in:s.push(t)}}),l+="]",r=p()(l,{data:o,allowRegexp:!0}).value,s.map(t=>{(0,m.remove)(r,a=>{let u=!t.value.includes(a[t.property]),g=!(0,m.some)(t.value,h=>a[h]);return u&&g})}),r}}return _.\u0275fac=function(o){return new(o||_)},_.\u0275prov=c.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()}}]);