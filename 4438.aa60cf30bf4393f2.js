(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4438],{2027:(I,O,h)=>{var d=h(4494),i=h(7839),r={};function f(n,e,a){for(var l=new d(e,a,f),t=0;t<n.length&&!o(n[t],l);t++);if(o(null,l),l.currentItem instanceof Object)l.addReference(l.currentItem);else{var u=function(n){for(var e=0;e<n.length;e++)if(!(n[e+1]&&n[e+1].value instanceof Object))return n[e].value}(l.currentParents);u&&l.addReference(u)}return{value:l.currentItem,key:l.currentKey,references:l.currentReferences,parents:l.currentParents}}function o(n,e){if(null==n)!e.currentItem&&e.options.force&&e.force(e.options.force);else if(n.values)if(e.currentItem){var a=Object.keys(e.currentItem),l=[];a.forEach(function(p){n.deep&&Array.isArray(e.currentItem[p])?e.currentItem[p].forEach(function(C){l.push(C)}):l.push(e.currentItem[p])}),e.setCurrent(a,l)}else e.setCurrent(a,[]);else if(n.get){var t=e.getValue(n.get);!function(n,e){return n.override&&n.currentItem===n.rootContext&&void 0!==n.override[e]}(e,t)?e.currentItem||e.options.force&&e.force({})?function(n,e){return n instanceof Array&&parseInt(e)!=e}(e.currentItem,t)||n.multiple?(l=e.currentItem.map(function(C){return C[t]}).filter(g),l=Array.prototype.concat.apply([],l),e.setCurrent(t,l)):e.setCurrent(t,e.currentItem[t]):e.setCurrent(t,null):e.setCurrent(t,e.override[t])}else if(n.select)if(Array.isArray(e.currentItem)||e.options.force&&e.force([])){var u=(n.boolean?n.select:[n]).map(function(p){if(":"===p.op){var C=e.getValue(p.select[0]);return{func:function(b){return C&&(b=b[C]),e.getValueFrom(p.select[1],b)},negate:p.negate,booleanOp:p.booleanOp}}var y=e.getValues(p.select);if(!e.options.allowRegexp&&"~"===p.op&&y[1]instanceof RegExp)throw new Error("options.allowRegexp is not enabled.");return{key:y[0],value:y[1],negate:p.negate,booleanOp:p.booleanOp,op:p.op}});if(n.multiple){a=[];var A=[];e.currentItem.forEach(function(C,y){s(C,u)&&(a.push(y),A.push(C))}),e.setCurrent(a,A)}else e.currentItem.some(function(p,C){if(s(p,u))return e.setCurrent(C,p),!0})||e.setCurrent(null,null)}else e.setCurrent(null,null);else if(n.root)e.resetCurrent(),e.setCurrent(null,n.args&&n.args.length?e.getValue(n.args[0]):e.rootContext);else if(n.parent)e.resetCurrent(),e.setCurrent(null,e.options.parent);else if(n.or){if(e.currentItem)return!0;e.resetCurrent(),e.setCurrent(null,e.context)}else if(n.filter){var T=e.getLocal(n.filter)||e.getGlobal(n.filter);if("function"==typeof T){l=e.getValues(n.args||[]);var m=T.apply(e.options,[e.currentItem].concat(l));e.setCurrent(null,m)}else{var F=e.getFilter(n.filter);"function"==typeof F&&(l=e.getValues(n.args||[]),m=F.call(e.options,e.currentItem,{args:l,state:e,data:e.rootContext}),e.setCurrent(null,m))}}else if(n.deep)if(e.currentItem){if(0===n.deep.length)return;if(m=e.deepQuery(e.currentItem,n.deep,e.options)){e.setCurrent(m.key,m.value);for(var x=0;x<m.parents.length;x++)e.currentParents.push(m.parents[x])}else e.setCurrent(null,null)}else e.currentItem=null}function s(n,e){for(var a=!1,l=0;l<e.length;l++){var t=e[l],u=!1;t.func?u=t.func(n):"~"===t.op?u=t.value instanceof RegExp?n[t.key]&&!!n[t.key].match(t.value):n[t.key]&&!!~n[t.key].indexOf(t.value):"="===t.op?u=!0===n[t.key]&&"true"===t.value||!1===n[t.key]&&"false"===t.value||n[t.key]==t.value:">"===t.op?u=n[t.key]>t.value:"<"===t.op?u=n[t.key]<t.value:">="===t.op?u=n[t.key]>=t.value:"<="===t.op&&(u=n[t.key]<=t.value),t.negate&&(u=!u),a="&"===t.booleanOp?a&&u:"|"===t.booleanOp&&a||u}return a}function g(n){return void 0!==n}I.exports=function(e,a){var l=a&&a.params||null;return Array.isArray(e)&&(l=e.slice(1),e=e[0]),r[e]||(r[e]=i(e,!0)),f(r[e],a,l)},I.exports.lastParent=function(n){var e=n.parents[n.parents.length-1];return e?e.value:null}},239:I=>{I.exports=function(h,d,i){var r=i&&i.max||1/0,f=i&&i.includeDelimiters||!1,o=0,s=0,g=[],v=[];h.replace(/([\[\(\{])|([\]\)\}])/g,function(e,a,l,t){a?(0===o&&v.push([s,t]),o+=1):l&&0==(o-=1)&&(s=t+e.length)}),0===o&&s<h.length&&v.push([s,h.length]),s=0;for(var P=0;P<v.length&&r>0;P++)for(var c=v[P][0],n=d.exec(h.slice(c,v[P][1]));n&&r>1;s=c+=n.index+n[0].length,n=d.exec(h.slice(c,v[P][1])))g.push(h.slice(s,n.index+c)),f&&g.push(n[0]),r-=1;return s<h.length&&g.push(h.slice(s)),g}},4494:I=>{function O(i,r,f){i=i||{},this.handleQuery=f,this.options=i,this.locals=this.options.locals||{},this.globals=this.options.globals||{},this.rootContext=h(i.data,i.rootContext,i.context,i.source),this.parent=i.parent,this.override=i.override,this.filters=i.filters||{},this.params=r||i.params||[],this.context=h(i.currentItem,i.context,i.source),this.currentItem=h(this.context,i.rootContext,i.data),this.currentKey=null,this.currentReferences=[],this.currentParents=[]}function h(i){for(var r=0;r<arguments.length;r++)if(null!=arguments[r])return arguments[r]}function d(i){var r={};if(i)for(var f in i)f in i&&(r[f]=i[f]);return r}I.exports=O,O.prototype={setCurrent:function(i,r){(this.currentItem||this.currentKey||this.currentParents.length>0)&&this.currentParents.push({key:this.currentKey,value:this.currentItem}),this.currentItem=r,this.currentKey=i},resetCurrent:function(){this.currentItem=null,this.currentKey=null,this.currentParents=[]},force:function(i){var r=this.currentParents[this.currentParents.length-1];return!this.currentItem&&r&&null!=this.currentKey&&(this.currentItem=i||{},r.value[this.currentKey]=this.currentItem),!!this.currentItem},getLocal:function(i){if(~i.indexOf("/")){for(var r=null,f=i.split("/"),o=0;o<f.length;o++){var s=f[o];0==o?r=this.locals[s]:r&&r[s]&&(r=r[s])}return r}return this.locals[i]},getGlobal:function(i){if(~i.indexOf("/")){for(var r=null,f=i.split("/"),o=0;o<f.length;o++){var s=f[o];0==o?r=this.globals[s]:r&&r[s]&&(r=r[s])}return r}return this.globals[i]},getFilter:function(i){if(~i.indexOf("/")){for(var r=null,f=i.split("/"),o=0;o<f.length;o++){var s=f[o];0==o?r=this.filters[s]:r&&r[s]&&(r=r[s])}return r}return this.filters[i]},addReferences:function(i){i&&i.forEach(this.addReference,this)},addReference:function(i){i instanceof Object&&!~this.currentReferences.indexOf(i)&&this.currentReferences.push(i)},getValues:function(i,r){return i.map(this.getValue,this)},getValue:function(i){return this.getValueFrom(i,null)},getValueFrom:function(i,r){if(null!=i._param)return this.params[i._param];if(i._sub){var f=d(this.options);f.force=null,f.currentItem=r;var o=this.handleQuery(i._sub,f,this.params);return this.addReferences(o.references),o.value}return i},deepQuery:function(i,r,f,o){for(var g in Object.keys(i),i)if(g in i){(f=d(this.options)).currentItem=i[g];var v=this.handleQuery(r,f,this.params);if(v.value)return v}return null}}},7839:(I,O,h)=>{var d=h(239);function f(c){var n=d(c,/(!)?(=|~|\:|<=|>=|<|>)/,{max:2,includeDelimiters:!0});if(3===n.length){var e="!"===n[1].charAt(0),a=s(n[0].trim()),l={negate:e,op:e?n[1].slice(1):n[1]};if(":"===l.op)l.select=[a,{_sub:I.exports(":"+n[2].trim())}];else if("~"===l.op){var t=s(n[2].trim());if("string"==typeof t){var u=n[2].trim().match(/^\/(.*)\/([a-z]?)$/);l.select=u?[a,new RegExp(u[1],u[2])]:[a,t]}else l.select=[a,t]}else l.select=[a,s(n[2].trim())];return l}}function s(c){if(function(c){return"{"===c.charAt(0)&&"}"===c.charAt(c.length-1)}(c)){var n=c.slice(1,-1);return{_sub:I.exports(n)}}return function(c){if("?"===c.charAt(0)){var n=parseInt(c.slice(1));return isNaN(n)?c:{_param:n}}return c}(c)}I.exports=function(c,n){if(!c)return[];var l,e=[],t=c.charAt(0),u=0,A=0,T=0,m=0,F=0,x="get",p=null;n&&(c=function(c){var n=0;return c.replace(/\?/g,function(e){return e+n++})}(c));var C={".":{mode:"get"},":":{mode:"filter"},"|":{handle:"or"},"[":{open:"select"},"]":{close:"select"},"{":{open:"meta"},"}":{close:"meta"},"(":{open:"args"},")":{close:"args"}};function y(_){p?p.push(_):e.push(_)}var b={get:function(_){var M="string"==typeof _?_.trim():null;M&&y({get:M})},select:function(_){if(_)y(function(c){if("*"===c)return{values:!0};if("**"===c)return{values:!0,deep:!0};var n=!1;"*"===c.charAt(0)&&(n=!0,c=c.slice(1));var e=d(c,/&|\|/,{includeDelimiters:!0});if(e.length>1){for(var a=[f(e[0].trim())],l=1;l<e.length;l+=2){var t=f(e[l+1].trim());t&&(t.booleanOp=e[l],a.push(t))}return{multiple:n,boolean:!0,select:a}}return(a=f(c.trim()))?(n&&(a.multiple=!0),a):{get:s(c.trim())}}(_));else{var M={deep:[]};e.push(M),p=M.deep}},filter:function(_){_&&y({filter:_.trim()})},or:function(){p=null,e.push({or:!0}),T=S+1},args:function(_){var M=function(c){return","===c?[","]:d(c,/,/).map(function(n){return s(n.trim())})}(_);e[e.length-1].args=M}};function D(){var _=c.slice(u,A);b[x]&&b[x](_),x="get",u=A+1}for(var S=0;S<c.length;S++){l=t,t=c.charAt(S+1),0==(m=S-T)&&":"!==l&&"."!==l&&e.push({root:!0}),0===m&&"."===l&&"."===t&&e.push({parent:!0});var E=C[l];E&&(0===F&&(E.mode||E.open)&&(D(),x=E.mode||E.open),0===F&&E.handle&&(D(),b[E.handle]()),E.open?F+=1:E.close&&(F-=1),0===F&&E.close&&D()),A=S+1}return D(),e}},4438:(I,O,h)=>{"use strict";h.d(O,{a:()=>n});var d=h(3132),r=h(9619),f=h(5415),o=h(1959),s=h(5793),g=h(6019);const v=function(e){return{chip_selected:e}};function P(e,a){if(1&e){const l=r.EpF();r.TgZ(0,"ion-chip",8),r.NdJ("click",function(){const A=r.CHM(l).$implicit,T=r.oxw().$implicit;return r.oxw().onChipClick(T,A)}),r.TgZ(1,"ion-label"),r._uU(2),r.qZA(),r.qZA()}if(2&e){const l=a.$implicit,t=r.oxw().$implicit,u=r.oxw();r.Q6J("ngClass",r.VKq(3,v,u.isFilterSet(t,l))),r.uIk("data-filterProperty",l.replaceAll(" ","_").replaceAll("'","")),r.xp6(2),r.Oqu(l)}}function c(e,a){if(1&e&&(r.TgZ(0,"ion-accordion"),r.TgZ(1,"ion-item",5),r.TgZ(2,"ion-label"),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",6),r.YNc(5,P,3,5,"ion-chip",7),r.qZA(),r.qZA()),2&e){const l=a.$implicit;r.xp6(3),r.Oqu(l.property),r.xp6(2),r.Q6J("ngForOf",l.value)}}let n=(()=>{class e{constructor(l,t,u){this.filterService=l,this.strutturaService=t,this.modalController=u,this.filters=[],this.filters=this.strutturaService.getFilterValues(),this.selectedFilters=this.filterService.getFilters(),console.log(this.filterService.getFilters())}ngOnInit(){console.dir(this.filterService.getFilters())}onChipClick(l,t){let u=this.getFilterByProperty(l);u?u.value.includes(t)?(0,d.remove)(u.value,A=>A===t):u.value.push(t):(u={property:l.property,operator:l.operator,value:[t]},this.selectedFilters.push(u)),console.log(this.filterService.getFilters())}getFilterByProperty(l){return this.selectedFilters.find(t=>t.property==l.property)}getFilterByValue(l,t){return this.selectedFilters.find(u=>u.property==l.property&&u.value.includes(t))}isFilterSet(l,t){return!(0,d.isNil)(this.getFilterByValue(l,t))}applyFilter(){console.log(this.selectedFilters),this.modalController.dismiss({filters:this.selectedFilters})}closeModal(){this.modalController.dismiss()}}return e.\u0275fac=function(l){return new(l||e)(r.Y36(f.F),r.Y36(o.h),r.Y36(s.IN))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-advanced-search"]],decls:13,vars:3,consts:[["slot","start"],[3,"click"],["slot","end"],[3,"multiple","value"],[4,"ngFor","ngForOf"],["slot","header"],["slot","content",1,""],["mode","md","class","filter_chip",3,"ngClass","click",4,"ngFor","ngForOf"],["mode","md",1,"filter_chip",3,"ngClass","click"]],template:function(l,t){1&l&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r.TgZ(2,"ion-buttons",0),r.TgZ(3,"ion-button",1),r.NdJ("click",function(){return t.closeModal()}),r._uU(4,"cancel"),r.qZA(),r.qZA(),r.TgZ(5,"ion-buttons",2),r.TgZ(6,"ion-button",1),r.NdJ("click",function(){return t.applyFilter()}),r._uU(7,"apply"),r.qZA(),r.qZA(),r.TgZ(8,"ion-title"),r._uU(9,"advanced-search"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(10,"ion-content"),r.TgZ(11,"ion-accordion-group",3),r.YNc(12,c,6,2,"ion-accordion",4),r.qZA(),r.qZA()),2&l&&(r.xp6(11),r.Q6J("multiple",!0)("value",1),r.xp6(1),r.Q6J("ngForOf",t.filters))},directives:[s.Gu,s.sr,s.Sm,s.YG,s.wd,s.W2,s.eh,g.sg,s.We,s.Ie,s.Q$,s.hM,g.mk],styles:[".filter_chip[_ngcontent-%COMP%]{text-align:center;background-color:#a0a0a0}.filter_chip.chip_selected[_ngcontent-%COMP%]{background-color:gray;font-weight:bold}"]}),e})()},5415:(I,O,h)=>{"use strict";h.d(O,{F:()=>g});var d=h(3132),r=h(2027),f=h.n(r),o=h(5306),s=h(9619);let g=(()=>{class v{constructor(){this.filters=[]}setFilters(c){this.filters=c}getFilters(){return this.filters}addFilter(c){let n=this.filters.findIndex(e=>e.property==c.property);n>-1?(0,d.set)(this.filters,`[${n}].value`,c.value):this.filters.push(c)}applyFilters(c,n){let e=[],a=[],l=`${n}[*`;return this.filters.map((t,u)=>{switch(t.operator){case o.p.eq:l+=`${t.property}=${t.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.gte:l+=`${t.property}>${t.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.gteq:l+=`${t.property}>=${t.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.lte:l+=`${t.property}<${t.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.lteq:l+=`${t.property}<=${t.value}`,l+=u<this.filters.length-1?" & ":"";break;case o.p.like:l+=`${t.property}~/.*${t.value}.*/i`,l+=u<this.filters.length-1?" & ":"";break;case o.p.in:a.push(t)}}),l+="]",e=f()(l,{data:c,allowRegexp:!0}).value,a.map(t=>{(0,d.remove)(e,u=>!t.value.includes(u[t.property]))}),e}}return v.\u0275fac=function(c){return new(c||v)},v.\u0275prov=s.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()}}]);